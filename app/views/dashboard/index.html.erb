<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Tableau de bord</h1>
    <a href="<%= new_search_profile_path %>" class="bg-primary-600 text-white px-6 py-2.5 rounded-lg font-medium hover:bg-primary-700">
      + Nouvelle recherche
    </a>
  </div>

  <!-- Stats -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <p class="text-sm text-gray-500">Recherches actives</p>
      <p class="text-3xl font-bold text-gray-900 mt-1"><%= @stats[:search_profiles] %></p>
    </div>
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <p class="text-sm text-gray-500">Annonces sauvegardÃ©es</p>
      <p class="text-3xl font-bold text-primary-600 mt-1"><%= @stats[:saved_listings] %></p>
    </div>
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <p class="text-sm text-gray-500">Favoris</p>
      <p class="text-3xl font-bold text-green-600 mt-1"><%= @stats[:favorites] %></p>
    </div>
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <p class="text-sm text-gray-500">Ã€ visiter</p>
      <p class="text-3xl font-bold text-orange-500 mt-1"><%= @stats[:to_visit] %></p>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Search Profiles -->
    <div class="lg:col-span-2">
      <h2 class="text-xl font-bold text-gray-900 mb-4">Mes recherches</h2>
      <% if @search_profiles.any? %>
        <div class="space-y-4">
          <% @search_profiles.each do |profile| %>
            <a href="<%= search_profile_path(profile) %>" class="block bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:border-primary-300 transition-colors">
              <div class="flex justify-between items-start">
                <div class="flex-1">
                  <div class="flex items-center gap-3 mb-2">
                    <span class="inline-block w-3 h-3 rounded-full <%= profile.active? ? 'bg-green-400' : 'bg-gray-300' %>"></span>
                    <h3 class="font-bold text-gray-900 text-lg">
                      <%= profile.city %>
                      <% if profile.arrondissement.present? %>
                        <span class="text-gray-500 text-sm">â€” <%= profile.arrondissement %></span>
                      <% end %>
                    </h3>
                    <span class="text-xs font-medium px-2.5 py-1 rounded-full <%= profile.transaction_type == 'sale' ? 'bg-amber-100 text-amber-700' : 'bg-blue-100 text-blue-700' %>">
                      <%= profile.transaction_label %>
                    </span>
                  </div>
                  <p class="text-gray-600 text-sm"><%= profile.summary %></p>
                  <div class="flex flex-wrap gap-3 mt-3 text-xs text-gray-500">
                    <span>ğŸ’° <%= profile.budget_label %></span>
                    <% if profile.rooms_label %><span>ğŸ  <%= profile.rooms_label %></span><% end %>
                    <% if profile.surface_label %><span>ğŸ“ <%= profile.surface_label %></span><% end %>
                  </div>
                </div>
                <span class="text-primary-600 text-sm font-medium ml-4">Voir â†’</span>
              </div>
            </a>
          <% end %>
        </div>
      <% else %>
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center">
          <p class="text-4xl mb-4">ğŸ”</p>
          <p class="text-gray-500 mb-4">Aucune recherche active</p>
          <a href="<%= new_search_profile_path %>" class="text-primary-600 font-medium hover:underline">CrÃ©er votre premiÃ¨re recherche â†’</a>
        </div>
      <% end %>
    </div>

    <!-- Recent Saved Listings -->
    <div>
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold text-gray-900">Annonces sauvegardÃ©es</h2>
        <a href="<%= saved_listings_path %>" class="text-sm text-primary-600 hover:underline">Tout voir â†’</a>
      </div>
      <% if @saved_listings.any? %>
        <div class="space-y-3">
          <% @saved_listings.each do |listing| %>
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
              <div class="flex justify-between items-start">
                <div class="flex-1">
                  <p class="font-medium text-gray-900 text-sm"><%= listing.title || listing.platform&.capitalize || "Annonce" %></p>
                  <% if listing.price %><p class="text-primary-600 font-bold text-sm"><%= number_to_currency(listing.price, unit: "â‚¬", format: "%n %u") %></p><% end %>
                  <div class="flex items-center gap-2 mt-1">
                    <span class="text-xs px-2 py-0.5 rounded-full <%= listing.status_color %>"><%= listing.status %></span>
                    <% if listing.platform %><span class="text-xs text-gray-400"><%= listing.platform %></span><% end %>
                  </div>
                </div>
                <a href="<%= listing.url %>" target="_blank" rel="noopener" class="text-xs bg-primary-50 text-primary-700 px-3 py-1 rounded-full hover:bg-primary-100">Voir â†—</a>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center">
          <p class="text-2xl mb-2">ğŸ“‹</p>
          <p class="text-gray-500 text-sm">Sauvegardez vos annonces favorites pour les comparer</p>
        </div>
      <% end %>
    </div>
  </div>
</div>
